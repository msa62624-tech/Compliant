# ═══════════════════════════════════════════════════════════════════
# PRODUCTION ENVIRONMENT CONFIGURATION TEMPLATE
# ═══════════════════════════════════════════════════════════════════
#
# SECURITY WARNING: 
# - NEVER commit this file with actual production secrets!
# - Copy this template to .env.production and fill in actual values
# - Add .env.production to .gitignore
# - Use environment-specific secrets management (AWS Secrets Manager, etc.)
#
# ═══════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────
# DATABASE CONFIGURATION
# ───────────────────────────────────────────────────────────────────
# Format: postgresql://[user]:[password]@[host]:[port]/[database]?[params]
# 
# Security Requirements:
#   ✓ Use SSL/TLS (add ?sslmode=require)
#   ✓ Strong password (20+ characters, mixed case, numbers, symbols)
#   ✓ Dedicated database user with minimal permissions
#   ✓ Connection pooling enabled
#   ✓ Use environment-specific database names (e.g., compliant_prod, compliant_staging)
#
# Example:
#   DATABASE_URL="postgresql://prod_user:SecurePass123xyz@db.example.com:5432/compliant_prod?sslmode=require&connection_limit=50"
#
# IMPORTANT: Use different database names for each environment to prevent
# accidental connections to the wrong database (prod, staging, dev).
# Note: If password contains special characters like @, %, /, ensure proper URL encoding
#
DATABASE_URL="postgresql://USER:PASSWORD@HOST:5432/DATABASE?sslmode=require"

# ───────────────────────────────────────────────────────────────────
# JWT AUTHENTICATION
# ───────────────────────────────────────────────────────────────────
# CRITICAL: Generate unique, cryptographically secure secrets
# 
# Generate with:
#   openssl rand -base64 32  (for each secret)
#
# Requirements:
#   ✓ Minimum 32 characters
#   ✓ Different for each environment (dev/staging/prod)
#   ✓ JWT_SECRET ≠ JWT_REFRESH_SECRET
#   ✓ Rotate quarterly for security
#
JWT_SECRET=""
JWT_REFRESH_SECRET=""

# Token expiration times
# Format: number + unit (s=seconds, m=minutes, h=hours, d=days)
# Examples: 15m, 1h, 7d
JWT_EXPIRATION="15m"
JWT_REFRESH_EXPIRATION="7d"

# ───────────────────────────────────────────────────────────────────
# REDIS (SESSION MANAGEMENT)
# ───────────────────────────────────────────────────────────────────
# Format: redis://[:password]@[host]:[port]/[db]
#         rediss://[:password]@[host]:[port]/[db] (with SSL)
#
# Security Requirements:
#   ✓ Enable password authentication
#   ✓ Use SSL/TLS (rediss://) when possible
#   ✓ Restrict network access
#
# Examples:
#   redis://:SecurePassword123@redis.example.com:6379/0
#   rediss://default:password@redis-cluster.amazonaws.com:6380
#
REDIS_URL="redis://:PASSWORD@HOST:6379/0"
SESSION_EXPIRATION="30d"

# ───────────────────────────────────────────────────────────────────
# EMAIL SERVICE CONFIGURATION
# ───────────────────────────────────────────────────────────────────
# Choose ONE email provider: sendgrid, aws_ses, or smtp
#
EMAIL_PROVIDER="sendgrid"

# ─── Option 1: SendGrid (Recommended for high volume) ─────────────
# Get API key: https://app.sendgrid.com/settings/api_keys
# Verify sender: https://app.sendgrid.com/settings/sender_auth
#
SENDGRID_API_KEY=""

# ─── Option 2: AWS SES (AWS Ecosystem) ────────────────────────────
# Setup: https://aws.amazon.com/ses/
# Note: Move out of SES sandbox for production
#
AWS_SES_REGION="us-east-1"
AWS_SES_ACCESS_KEY=""
AWS_SES_SECRET_KEY=""

# ─── Option 3: SMTP (Microsoft 365, Gmail, etc.) ───────────────────
# Microsoft 365: smtp.office365.com:587
# Gmail: smtp.gmail.com:587 (requires app password if MFA enabled)
#
SMTP_HOST="smtp.office365.com"
SMTP_PORT="587"
SMTP_USER=""
SMTP_PASS=""

# ─── Common Email Settings ─────────────────────────────────────────
# Must be verified sender address
EMAIL_FROM="noreply@yourdomain.com"

# ───────────────────────────────────────────────────────────────────
# FILE STORAGE CONFIGURATION
# ───────────────────────────────────────────────────────────────────
# Choose ONE storage provider: s3, azure, or local
#
STORAGE_PROVIDER="s3"

# ─── Option 1: AWS S3 ──────────────────────────────────────────────
# Create bucket: https://s3.console.aws.amazon.com/
# Configure CORS, lifecycle policies, versioning
#
AWS_S3_BUCKET=""
AWS_S3_REGION="us-east-1"
AWS_S3_ACCESS_KEY=""
AWS_S3_SECRET_KEY=""

# ─── Option 2: Azure Blob Storage ──────────────────────────────────
AZURE_STORAGE_CONNECTION_STRING=""
AZURE_STORAGE_CONTAINER="documents"

# ─── Option 3: Local Storage (requires persistent volume) ──────────
LOCAL_STORAGE_PATH="/var/compliant/uploads"

# ─── Storage Security Settings ─────────────────────────────────────
MAX_FILE_SIZE="10485760"  # 10MB in bytes
ALLOWED_FILE_TYPES="pdf,jpg,jpeg,png,doc,docx"

# Virus scanning (optional but recommended)
VIRUS_SCAN_ENABLED="false"
CLAMAV_HOST="localhost"
CLAMAV_PORT="3310"

# ───────────────────────────────────────────────────────────────────
# FIELD-LEVEL ENCRYPTION
# ───────────────────────────────────────────────────────────────────
# CRITICAL: Required for encrypting sensitive data in database
#
# Generate with:
#   openssl rand -base64 32  (for ENCRYPTION_KEY)
#   openssl rand -hex 16     (for ENCRYPTION_SALT)
#
# Requirements:
#   ✓ ENCRYPTION_KEY: 32+ characters
#   ✓ ENCRYPTION_SALT: 16+ characters
#   ✓ Unique per environment
#   ✓ Back up securely (lost keys = lost data)
#
ENCRYPTION_KEY=""
ENCRYPTION_SALT=""

# ───────────────────────────────────────────────────────────────────
# SERVER CONFIGURATION
# ───────────────────────────────────────────────────────────────────
PORT=3001
NODE_ENV="production"

# ───────────────────────────────────────────────────────────────────
# CORS CONFIGURATION
# ───────────────────────────────────────────────────────────────────
# CRITICAL: Only include production domains
#
# Format: Single or comma-separated list
# Examples:
#   CORS_ORIGIN="https://app.yourdomain.com"
#   CORS_ORIGIN="https://app.yourdomain.com,https://admin.yourdomain.com,https://broker.yourdomain.com"
#
# Security Requirements:
#   ✓ Use HTTPS only (no HTTP)
#   ✓ NO localhost or development URLs
#   ✓ Specific domains (no wildcards in production)
#
CORS_ORIGIN="https://app.yourdomain.com"

# ───────────────────────────────────────────────────────────────────
# ADMIN CONFIGURATION
# ───────────────────────────────────────────────────────────────────
ADMIN_EMAIL="admin@yourdomain.com"
AUDIT_LOG_RETENTION_DAYS="365"

# Portal configuration
GC_PORTAL_ENABLED="true"
GC_PORTAL_URL="https://gc.yourdomain.com"
BROKER_PORTAL_ENABLED="true"
BROKER_PORTAL_URL="https://broker.yourdomain.com"

# ───────────────────────────────────────────────────────────────────
# POLICY EXPIRATION ALERTS (Renewal Reminders)
# ───────────────────────────────────────────────────────────────────
# Automated reminder system configuration
#
# Note: Cron job runs daily at 6 AM (configured in code)
# These settings control notification preferences
#
EXPIRING_POLICY_ALERT_DAYS="30,15,7,1"  # Days before expiration for alerts
POLICY_ALERT_EMAIL_ENABLED="true"       # Enable email notifications
POLICY_ALERT_FREQUENCY="daily"          # Frequency: daily, weekly

# SMS notifications (optional)
NOTIFICATION_SMS_ENABLED="false"
TWILIO_ACCOUNT_SID=""
TWILIO_AUTH_TOKEN=""
TWILIO_FROM_NUMBER=""

# ───────────────────────────────────────────────────────────────────
# EXTERNAL INTEGRATIONS (Optional)
# ───────────────────────────────────────────────────────────────────

# ─── AI & Document Processing ──────────────────────────────────────
AI_PROVIDER="openai"
OPENAI_API_KEY=""
ANTHROPIC_API_KEY=""
AI_MODEL="gpt-4"
AI_TEMPERATURE="0.2"
AI_MAX_TOKENS="2000"

# Adobe PDF Services (for document processing)
ADOBE_CLIENT_ID=""
ADOBE_CLIENT_SECRET=""
ADOBE_ORGANIZATION_ID=""

# ─── NYC Department of Buildings (ACRIS Data) ──────────────────────
NYC_DOB_API_KEY=""
NYC_DOB_API_URL="https://data.cityofnewyork.us/resource/"
NYC_DOB_CACHE_TTL="3600"

# ─── Google Places (Address Validation) ───────────────────────────
GOOGLE_PLACES_API_KEY=""
GOOGLE_PLACES_CACHE_TTL="86400"

# ───────────────────────────────────────────────────────────────────
# MONITORING & LOGGING (Optional but Recommended)
# ───────────────────────────────────────────────────────────────────

# ─── Error Tracking (Sentry) ───────────────────────────────────────
SENTRY_DSN=""
SENTRY_ENVIRONMENT="production"
SENTRY_TRACES_SAMPLE_RATE="1.0"

# ─── Application Performance Monitoring ────────────────────────────
# New Relic
NEW_RELIC_LICENSE_KEY=""
NEW_RELIC_APP_NAME="Compliant-Production"

# DataDog
DD_API_KEY=""
DD_APP_KEY=""
DD_SITE="datadoghq.com"

# ───────────────────────────────────────────────────────────────────
# FRONTEND CONFIGURATION
# ───────────────────────────────────────────────────────────────────
# Used by backend for generating links in emails
#
FRONTEND_URL="https://app.yourdomain.com"

# ───────────────────────────────────────────────────────────────────
# SECURITY HEADERS & RATE LIMITING
# ───────────────────────────────────────────────────────────────────
# These are configured in code but can be overridden

# Rate limiting (requests per time window)
THROTTLE_TTL="60"    # Time window in seconds
THROTTLE_LIMIT="100" # Max requests per window

# Content Security Policy
CSP_ENABLED="true"

# ═══════════════════════════════════════════════════════════════════
# VALIDATION CHECKLIST
# ═══════════════════════════════════════════════════════════════════
#
# Before deploying, verify:
#   ☐ All CRITICAL fields are filled (DATABASE_URL, JWT secrets, etc.)
#   ☐ JWT_SECRET is 32+ characters
#   ☐ JWT_REFRESH_SECRET is different from JWT_SECRET
#   ☐ ENCRYPTION_KEY and ENCRYPTION_SALT are generated
#   ☐ Database URL includes sslmode=require
#   ☐ CORS_ORIGIN has ONLY production domains (no localhost)
#   ☐ NODE_ENV is set to "production"
#   ☐ Email provider is configured and sender verified
#   ☐ Storage provider is configured
#   ☐ No placeholder values remain (change-in-production, etc.)
#
# ═══════════════════════════════════════════════════════════════════
